<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">  
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lilith Crow (Lua Hot)</title>
    <link rel="stylesheet" href="style.css">

    <!-- SUPABASE CORE 2026 - LINK CORRIGIDO -->
    <script src="cdn.jsdelivr.net"></script>

    <script>
        // Configurações do seu Supabase
        const SUPABASE_URL = 'https://lcdwunihbqeozqypsyko.supabase.co';
        const SUPABASE_KEY = 'SUA_SERVICE_ROLE_KEY_AQUI'; // <--- COLE SUA CHAVE AQUI
        const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        document.addEventListener("DOMContentLoaded", async function() {
            const isAdmin = sessionStorage.getItem('logadoAdmin') === 'true';
            const isMembro = sessionStorage.getItem('logadoMembro') === 'true';
            const nomeUsuario = localStorage.getItem('nomeUsuario');

            // Validação de segurança extra com o banco de dados
            let acessoLiberado = isAdmin;

            if (isMembro && nomeUsuario) {
                // Buscando na tabela correta: membros
                const { data, error } = await _supabase
                    .from('membros')
                    .select('aprovado')
                    .eq('usuario', nomeUsuario)
                    .single();
                
                if (!error && data && data.aprovado) {
                    acessoLiberado = true;
                } else {
                    // Se não estiver aprovado no banco, limpa a sessão para travar os links
                    sessionStorage.removeItem('logadoMembro');
                    acessoLiberado = false;
                }
            }

            if (acessoLiberado) {
                console.log("Acesso Confirmado 2026: Liberando links...");
                const links = document.querySelectorAll('nav ul li a');
                links.forEach(link => {
                    if (link.classList.contains('travado')) {
                        link.classList.remove('travado'); 
                        link.style.opacity = "1";
                        link.style.cursor = "pointer";
                        link.href = "login.liberado.html";
                        link.onclick = null;
                    }
                });

                const foto = document.getElementById('foto-principal');
                if(foto) foto.style.pointerEvents = "auto";

                const btnLogin = document.getElementById('btn-login');
                if(btnLogin) {
                    btnLogin.innerText = isAdmin ? "SAIR (ADMIN)" : "SAIR";
                    btnLogin.style.color = "#ff0000";
                    btnLogin.href = "javascript:void(0)";
                    btnLogin.onclick = function() {
                        sessionStorage.clear();
                        localStorage.removeItem('nomeUsuario');
                        location.reload(); 
                    };
                }
            }
        });

        function verificarAcesso(url) {
            const isAdmin = sessionStorage.getItem('logadoAdmin') === 'true';
            const isMembro = sessionStorage.getItem('logadoMembro') === 'true';

            if (isAdmin || isMembro) {
                window.location.href = url;
            } else {
                alert("Acesso Negado! Fotos, Vídeos e Chat são exclusivos para assinantes.");
                window.location.href = "login.html";
            }
        }
    </script>
</head>
<body>

    <style>
        /* Mantendo seu layout original exatamente como solicitado */
        img {
            -webkit-user-drag: none;
            user-select: none;
            pointer-events: none; 
        }
        .travado {
            cursor: not-allowed;
            opacity: 0.5;
        }
    </style>

    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="materias.html">Materias</a></li>
            
            <li><a href="javascript:void(0)" class="travado" id="link-fotos" onclick="verificarAcesso('login.liberado.html')">Fotos</a></li>
            <li><a href="javascript:void(0)" class="travado" id="link-videos" onclick="verificarAcesso('login.liberado.html')">Videos</a></li>
            <li><a href="javascript:void(0)" class="travado" id="link-chat" onclick="verificarAcesso('login.liberado.html')">Chat ao Vivo</a></li>
            
            <li><a href="login.html" id="btn-login" style="font-weight: bold; color: yellow;">LOGIN</a></li>
        </ul>
    </nav>

    <header>
        <img src="fotos/imagens/00011.jpg" alt="Imagem de Lilith Crow" id="foto-principal">
    </header>

    <main>
        <h1>Bem vindos ao site HOT de Lilith Crow(LUA).</h1>
        <br>
        <h2>ASSINEM AGORA E VEJA, OS CONTEÚDOS EXCLUSIVOS.</h2>
        <h3>Fotos, Vídeos e Chat ao Vivo, só é permitido acesso com a assinatura mensal.</h3>
        <h3>CLIQUE EM LOGIN NO MENU PRINCIPAL E SE CADASTRE E ACESSE OS CONTEÚDOS EXCLUSIVOS!</h3>
    </main>

</body>
</html>
