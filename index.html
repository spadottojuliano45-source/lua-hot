<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">  
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lilith Crow (Lua Hot)</title>
    <link rel="stylesheet" href="style.css">

    <!-- SUPABASE CORE 2026 -->
    <script src="cdn.jsdelivr.net"></script>

    <script>
        const SUPABASE_URL = 'https://lcdwunihbqeozqypsyko.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxjZHd1bmloYnFlb3pxeXBzeWtvIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2ODI3NjgzNywiZXhwIjoyMDgzODUyODM3fQ.XukvV_Pqe6YbJP7FWi4R_O2MTLhw6sV-w2AnQ-nTWsk'; 
        
        let _supabase;
        try {
            _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        } catch (e) { console.error("Erro Supabase:", e); }

        document.addEventListener("DOMContentLoaded", async function() {
            const isAdmin = sessionStorage.getItem('logadoAdmin') === 'true';
            const isMembro = sessionStorage.getItem('logadoMembro') === 'true';
            const nomeUsuario = localStorage.getItem('nomeUsuario');

            let acessoLiberado = isAdmin;

            // Validação em tempo real com seu banco
            if (isMembro && nomeUsuario && _supabase) {
                const { data, error } = await _supabase
                    .from('membros')
                    .select('aprovado')
                    .eq('usuario', nomeUsuario)
                    .single();
                
                if (!error && data && data.aprovado) {
                    acessoLiberado = true;
                } else {
                    sessionStorage.removeItem('logadoMembro');
                }
            }

            // SE LOGADO: Libera tudo sem mudar de página
            if (acessoLiberado) {
                const links = {
                    'link-fotos': 'fotos.html',
                    'link-videos': 'videos.html',
                    'link-chat': 'chat.html'
                };

                Object.keys(links).forEach(id => {
                    const el = document.getElementById(id);
                    if(el) {
                        el.classList.remove('travado');
                        el.href = links[id];
                        el.onclick = null; // Remove o alerta
                        el.style.opacity = "1";
                    }
                });

                // Libera a Foto Principal
                const foto = document.getElementById('foto-principal');
                if(foto) {
                    foto.style.pointerEvents = "auto";
                    foto.style.filter = "none";
                }

                // Troca Botão Login para Sair
                const btnLogin = document.getElementById('btn-login');
                if(btnLogin) {
                    btnLogin.innerText = "SAIR (" + (nomeUsuario || "ADMIN") + ")";
                    btnLogin.style.color = "#ff4444";
                    btnLogin.href = "#";
                    btnLogin.onclick = () => { sessionStorage.clear(); location.reload(); };
                }
            }
        });

        function verificarAcesso() {
            alert("Acesso Negado! Fotos, Vídeos e Chat são exclusivos para assinantes ativos.");
            window.location.href = "login.html";
        }
    </script>
</head>
<body>

    <style>
        img { -webkit-user-drag: none; user-select: none; pointer-events: none; }
        .travado { cursor: not-allowed !important; opacity: 0.4 !important; filter: grayscale(100%); }
    </style>

    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="materias.html">Materias</a></li>
            
            <!-- Links começam travados por padrão -->
            <li><a href="javascript:void(0)" class="travado" id="link-fotos" onclick="verificarAcesso()">Fotos</a></li>
            <li><a href="javascript:void(0)" class="travado" id="link-videos" onclick="verificarAcesso()">Videos</a></li>
            <li><a href="javascript:void(0)" class="travado" id="link-chat" onclick="verificarAcesso()">Chat ao Vivo</a></li>
            
            <li><a href="login.html" id="btn-login" style="font-weight: bold; color: yellow;">LOGIN</a></li>
        </ul>
    </nav>

    <header>
        <img src="fotos/imagens/00011.jpg" alt="Imagem de Lilith Crow" id="foto-principal" style="transition: 0.5s; filter: blur(5px);">
    </header>

    <main>
        <h1>Bem vindos ao site HOT de Lilith Crow (LUA).</h1>
        <br>
        <h2>ASSINEM AGORA E VEJA OS CONTEÚDOS EXCLUSIVOS.</h2>
        <h3>Fotos, Vídeos e Chat ao Vivo são permitidos apenas com assinatura.</h3>
    </main>

</body>
</html>
